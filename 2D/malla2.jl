xnod = [ 
       1    0.0000      1.0000     
       2    0.0000      2.0000     
       3    0.0000      1.0833     
       4    0.0000      1.1667     
       5    0.0000      1.2500     
       6    0.0000      3.0000     
       7    0.0000      2.1667     
       8    0.0000      2.3333     
       9    0.0000      2.4167     
      10    3.0000      0.0000     
      11    2.9990     0.78459E-01 
      12    2.9959     0.15686     
      13    2.9908     0.23538     
      14    2.9836     0.31373     
      15    2.9743     0.39165     
      16    2.9631     0.46930     
      17    2.9498     0.54671     
      18    2.9344     0.62374     
      19    2.8978     0.77646     
      20    2.8532     0.92705     
      21    2.7716      1.1481     
      22    2.6730      1.3620     
      23    2.5981      1.5        # cargaa
      24    2.4271      1.7634     
      25    2.2812      1.9483     
      26    2.1213      2.1213     
      27    1.9483      2.2812     
      28    1.7634      2.4271     
      29    1.50        2.5981     # carga
      30    2.0000      0.0000     
      31    2.1667      0.0000     
      32    2.3333      0.0000     
      33    2.4167      0.0000     
      34    1.0000      0.0000     
      35    1.0833      0.0000     
      36    1.1667      0.0000     
      37    1.2500      0.0000     
      38   0.99786     0.65403E-01 
      39   0.99144     0.13053     
      40   0.98079     0.19509     
      41   0.96593     0.25882     
      42   0.94693     0.32144     
      43   0.92388     0.38268     
      44   0.89687     0.44229     
      45    1.7654      1.1852     
      46    1.9184     0.78185     
      47    2.2457     0.74767     
      48    2.2981      1.2338     
      49    2.5000      0.0000     
      50   0.85685      1.3184     
      51    1.4061     0.60012     
      52    1.0039      2.3272     
      53    1.8112     0.50329     
      54    2.3294     0.45531     
      55    2.5285     0.92038     
      56    2.0030      1.5049     
      57    1.6751      1.7364     
      58    1.1690      1.9459     
      59    1.3620      2.6730     
      60   0.50745      2.5482     
      61   0.70980      2.1677     
      62    1.0874     0.92998     
      63    2.0683      1.0378     
      64   0.59109      1.1127     
      65   0.31236      2.0772     
      66    1.1579     0.51097     
      67    1.4336     0.23048     
      68    2.3855     0.73943     
      69    2.4249     0.23694     
      70    2.6397     0.47953     
      71    2.6908     0.92372     
      72    2.4856      1.2979     
      73    2.2150      1.6341     
      74    1.8982      1.9289     
      75    1.4662      2.1865     
      76    1.1830      2.5001     
      77    0.0000      2.5000     
      78   0.44902      2.6917     
      79   0.28404      2.4844     
      80    1.9196     0.24166     
      81   0.43448      1.4810     
      82    1.9168      1.1115     
      83    1.8842      1.3451     
      84    1.7111      1.0312     
      85    1.3333      0.0000     
      86    1.8648     0.64257     
      87    2.4167     0.87561     
      88    1.1481      2.7716     
      89    1.9933     0.90984     
      90    2.5833      0.0000     
      91    2.1866     0.93434     
      92    2.4133      1.0771     
      93    2.1506      1.3694     
      94    2.1832      1.1358     
      95    1.3620      1.0632     
      96    0.0000      1.3333     
      97   0.92705      2.8532     
      98   0.88822     0.78670     
      99    1.6929     0.52010     
     100   0.89876      2.4411     
     101   0.85687      2.2475     
     102    1.0865      2.1366     
     103    2.6667      0.0000     
     104    1.9536     0.48937     
     105   0.77646      2.8978     
     106    1.8391      1.6207     
     107    1.4221      1.8412     
     108    1.5077      1.5047     
     109    2.3050     0.83083     
     110   0.66601      2.2690     
     111   0.62374      2.9344     
     112   0.54671      2.9498     
     113    0.0000      2.5833     
     114    0.0000      2.6667     
     115   0.86603     0.50000     
     116   0.79335     0.60876     
     117   0.70711     0.70711     
     118   0.60876     0.79335     
     119    1.4167      0.0000     
     120    1.5000      0.0000     
     121    0.0000      1.4167     
     122    0.0000      1.5000     
     123   0.50000     0.86603     
     124   0.44229     0.89687     
     125   0.34956      1.1275     
     126   0.17852      1.1612     
     127   0.23807      1.3269     
     128   0.47687      1.2795     
     129    1.1474     0.13851     
     130    1.1159     0.29118     
     131    1.2569     0.29833     
     132    1.3038     0.14576     
     133    1.0013     0.62697     
     134    1.1572     0.78535     
     135    1.2356     0.55147     
     136    1.0802     0.47047     
     137   0.56047     0.95975     
     138   0.77514     0.94642     
     139   0.50388      1.0583     
     140   0.67830      1.1671     
     141   0.16370      2.8146     
     142   0.31594      2.8145     
     143   0.32236      2.6282     
     144   0.18741      2.6432     
     145    2.7742     0.31489     
     146    2.7977     0.16114     
     147    2.6216     0.16312     
     148    2.5805     0.32085     
     149   0.60473      2.6716     
     150   0.79358      2.5549     
     151   0.42925      2.6444     
     152   0.46880      2.7389     
     153    2.6512     0.67407     
     154    2.4661     0.64804     
     155    2.7394     0.48249     
     156    2.5401     0.47657     
     157   0.32837      2.1983     
     158   0.42824      2.3562     
     159   0.21680      2.4791     
     160   0.35128      2.4897     
     161   0.62222      2.3702     
     162   0.27784      1.6955     
     163   0.29635      1.9561     
     164   0.72547      1.9325     
     165   0.68683      1.6879     
     166   0.57539      1.4582     
     167   0.29357      1.5039     
     168    1.6513     0.22554     
     169    1.5264     0.33536     
     170    1.4710     0.15588     
     171    1.3962     0.30507     
     172    2.3528     0.12455     
     173    2.1879     0.25778     
     174    2.3775     0.31312     
     175    2.4724     0.16076     
     176    2.1864     0.66452     
     177    2.3371     0.58506     
     178    2.0960     0.47545     
     179    1.6567     0.87726     
     180    1.5745     0.53691     
     181    1.3838     0.85355     
     182    1.3403      1.2729     
     183    1.0176      1.0746     
     184    1.0383      1.5577     
     185   0.86256      1.6228     
     186   0.70790      2.4626     
     187   0.11903      1.3301     
     188   0.89259E-01  1.1639     
     189   0.15415      1.0764     
     190   0.20829      1.2440     
     191   0.26404      1.1444     
     192   0.26582      1.4154     
     193   0.35747      1.3032     
     194   0.52613      1.3688     
     195   0.41322      1.2035     
     196   0.57759      1.2233     
     197   0.30456      1.0466     
     198   0.42672      1.0929     
     199    1.2463     0.42490     
     200    1.0981     0.38082     
     201    1.0409     0.27500     
     202    1.1864     0.29476     
     203    1.1316     0.21484     
     204    1.3266     0.30170     
     205    1.2804     0.22205     
     206    1.3874     0.15082     
     207    1.2256     0.14213     
     208    1.3186     0.72880E-01 
     209    1.0694     0.13452     
     210    1.1570     0.69253E-01 
     211    1.3208     0.57580     
     212    1.2705     0.81945     
     213    1.0792     0.70616     
     214    1.1964     0.66841     
     215    1.0408     0.54872     
     216    1.0020     0.42658     
     217   0.93366     0.56349     
     218   0.44328     0.99107     
     219   0.53023     0.91289     
     220   0.53217      1.0090     
     221   0.66780     0.95309     
     222   0.72672      1.0568     
     223   0.76757      1.2428     
     224   0.74112     0.82676     
     225   0.89635      1.0105     
     226   0.37581      2.6363     
     227   0.39237      2.7767     
     228   0.31476      2.8990     
     229   0.31915      2.7213     
     230   0.23982      2.8145     
     231   0.33682      2.5589     
     232   0.25489      2.6357     
     233   0.20210      2.5611     
     234   0.17555      2.7289     
     235   0.93703E-01  2.6549     
     236   0.16036      2.9052     
     237   0.81851E-01  2.8240     
     238    2.6441     0.81560E-01 
     239    2.8155     0.80569E-01 
     240    2.8968     0.15900     
     241    2.7097     0.16213     
     242    2.7860     0.23801     
     243    2.5470     0.16194     
     244    2.6010     0.24198     
     245    2.4790     0.31698     
     246    2.6774     0.31787     
     247    2.5603     0.39871     
     248    2.8789     0.31431     
     249    2.7568     0.39869     
     250   0.46835      2.5963     
     251   0.55609      2.6099     
     252   0.53676      2.7052     
     253   0.46905      2.8510     
     254   0.69916      2.6133     
     255   0.61423      2.8030     
     256   0.86032      2.7040     
     257    2.8512     0.47590     
     258    2.7928     0.64890     
     259    2.5898     0.79723     
     260    2.6953     0.57828     
     261    2.5586     0.66105     
     262    2.5031     0.56231     
     263    2.4347     0.46594     
     264    2.4016     0.61655     
     265   0.10840      2.4896     
     266   0.16419      2.2658     
     267   0.51909      2.1830     
     268   0.27259      2.3387     
     269   0.37830      2.2773     
     270   0.38976      2.4229     
     271   0.42937      2.5189     
     272   0.56484      2.4592     
     273   0.52523      2.3632     
     274   0.71612      1.3883     
     275   0.71764      2.0501     
     276   0.70615      1.8102     
     277   0.51091      1.9443     
     278   0.48234      1.6917     
     279   0.63111      1.5730     
     280   0.28570      1.5997     
     281   0.14678      1.5019     
     282   0.28709      1.8258     
     283   0.13892      1.6811     
     284   0.14817      1.9781     
     285    1.4855     0.77939E-01 
     286    1.6590     0.11277     
     287    1.7313     0.36441     
     288    1.5612     0.19071     
     289    1.5889     0.28045     
     290    1.4613     0.32022     
     291    1.4012     0.45260     
     292    1.5505     0.43614     
     293    2.3534     0.38422     
     294    2.1420     0.36661     
     295    2.0940     0.12889     
     296    2.2703     0.19117     
     297    2.2827     0.28545     
     298    2.4126     0.14266     
     299    2.4862     0.80382E-01 
     300    2.3430     0.62277E-01 
     301    2.0524     0.72318     
     302    2.2127     0.46538     
     303    2.1412     0.56998     
     304    2.2617     0.62479     
     305    2.3332     0.52019     
     306    1.7875     0.82955     
     307    1.3950     0.72684     
     308    1.5202     0.86541     
     309    1.6156     0.70709     
     310    1.4903     0.56852     
     311    1.5528      1.2290     
     312   0.93721      1.1965     
     313    1.1893      1.4153     
     314    1.1789      1.1737     
     315   0.94726      1.9392     
     316    1.1037      1.7518     
     317   0.94756      1.4381     
     318    2.7500      0.0000     
     319    1.5833      0.0000     
     320    0.0000      1.5833     
     321    0.0000      2.7500     
     322   0.46930      2.9631     
     323   0.39158      2.9743     
     324   0.31359      2.9836     
     325   0.23538      2.9908     
     326    2.8333      0.0000     
     327    2.9167      0.0000     
     328   0.15701      2.9959     
     329    0.0000      2.8333     
     330    0.0000      2.9167     
     331   0.78531E-01  2.9990     
     332   0.38268     0.92388     
     333   0.32180     0.94681     
     334   0.25955     0.96573     
     335    1.6667      0.0000     
     336    1.8333      0.0000     
     337   0.19509     0.98079     
     338   0.12978     0.99154     
     339   0.65025E-01 0.99788     
     340    0.0000      1.6667     
     341    0.0000      1.8333];



LaG = [ 
 149   251    60   272   161   186   150   254
 63    89    46   301   176    47   109    91
 125   197   334   333   332   218   139   198
 129   209    39    38    34    35    36   210
 138   224   117   116   115   217   133    98
 163   277   164   275    61   267   157    65
 141   236   328   331     6   330   329   237
 145   248    14    15    16   257   155   249
 149   254   150   256    97   105   111   255
 183   225   138    98   133   213   134    62
  48    92    55    71    20    21    22    72
  56    93    48    72    22    23    24    73
  57   106    56    73    24    25    26    74
  58   107    57    74    26    27    28    75
 150   100    52    76    59    88    97   256
  58    75    28    29    59    76    52   102
 161   273   158   269   157   267    61   110
 162   282   163   284     2   341   340   283
 180   292   169   289   168   287    53    99
  32   300   172   296   173   295    30    31
 178   302    54   305   177   304   176   303
 181   307    51   310   180   309   179   308
  48    94    63    91   109    87    55    92
  45    82    63    94    48    93    56    83
  57   108   182   311    45    83    56   106
  46    89    63    82    45    84   179   306
 181   308   179    84    45   311   182    95
  50   312   183   314   182   313   184   317
 164   276   165   185   184   316    58   315
 181    95   182   314   183    62   134   212
 182   108    57   107    58   316   184   313
  58   102    52   101    61   275   164   315
 177   264   154    68   109    47   176   304
 154   261   153   259    55    87   109    68
  53   287   168    80   173   294   178   104
 168   286   335   336    30   295   173    80
   2   284   163    65   157   266     8     7
  52   100   150   186   161   110    61   101
 151   250    60   251   149   252   152    78
 137   219   123   118   117   224   138   221
 153   258    18    19    20    71    55   259
 165   279   166   274    50   317   184   185
 122   121    96   187   127   192   167   281
  96     5     4   188   126   190   127   187
   4     3     1   339   338   189   126   188
 126   189   338   337   334   197   125   191
 127   190   126   191   125   195   128   193
 167   192   127   193   128   194   166    81
 166   194   128   196   140   223    50   274
 128   195   125   198   139    64   140   196
  51   211   135   199   131   204   171   291
 135    66   136   200   130   202   131   199
 136   216    43    42    41   201   130   200
 130   201    41    40    39   209   129   203
 131   202   130   203   129   207   132   205
 171   204   131   205   132   206   170    67
 170   206   132   208    85   119   120   285
 132   207   129   210    36    37    85   208
  51   307   181   212   134   214   135   211
 134   213   133   215   136    66   135   214
 136   215   133   217   115    44    43   216
 332   124   123   219   137   220   139   218
 139   220   137   221   138   222   140    64
 140   222   138   225   183   312    50   223
  60   250   151   226   143   231   160   271
 151    78   152   227   142   229   143   226
 152   253   322   323   324   228   142   227
 142   228   324   325   328   236   141   230
 143   229   142   230   141   234   144   232
 160   231   143   232   144   233   159    79
 159   233   144   235   114   113    77   265
 144   234   141   237   329   321   114   235
  49    90   103   238   147   243   175   299
 103   318   326   239   146   241   147   238
 326   327    10    11    12   240   146   239
 146   240    12    13    14   248   145   242
 147   241   146   242   145   246   148   244
 175   243   147   244   148   245   174    69
 174   245   148   247   156   263    54   293
 148   246   145   249   155    70   156   247
 152   252   149   255   111   112   322   253
  16    17    18   258   153   260   155   257
 155   260   153   261   154   262   156    70
 156   262   154   264   177   305    54   263
  77     9     8   266   157   268   159   265
 159   268   157   269   158   270   160    79
 160   270   158   273   161   272    60   271
 165   276   164   277   163   282   162   278
 165   278   162   280   167    81   166   279
 167   280   162   283   340   320   122   281
 120   319   335   286   168   288   170   285
 170   288   168   289   169   290   171    67
 171   290   169   292   180   310    51   291
  54   302   178   294   173   297   174   293
 173   296   172   298   175    69   174   297
 175   298   172   300    32    33    49   299
  53   104   178   303   176   301    46    86
 179   309   180    99    53    86    46   306
]
xnod = xnod[:,2:3]
#%% Se definen las restricciones
X = 1; Y = 2;
nodos_restringidos = [1 3 339 34 35 38 10 11 327 6 330 331]';
nnr = length(nodos_restringidos);
restricciones = [ nodos_restringidos repeat([X],nnr) round.(Int, zeros(nnr,1))
                  nodos_restringidos repeat([Y],nnr) round.(Int, zeros(nnr,1)) ];
